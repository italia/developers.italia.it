"use strict";function esDevelopersItaliaManager(e,t,i,r){this.config=$.extend({inputSelector:"",totalSelector:".results-number",pagerSelector:"#paginator",sortSelector:".sortingBy form select",sortMobileSelector:"#sortBy .modal-body a",sortMobileModal:"#sortBy",sortMobileTitle:{it:{relevance:"Rilevanza",az:"A/Z",za:"Z/A",popularity:"Popolarità",emerging:"Emergenti"},en:{relevance:"Relevance",az:"A/Z",za:"Z/A",popularity:"Popularity",emerging:"Emerging"}},pageContent:".list-item-sorting > div",filterKeys:{tags:"list-tags",developmentStatus:"list-status"},filterKeysMobileSelectors:{tags:"pills-arguments",developmentStatus:"pills-development_status"}},t),this.objectConfig=$.extend({},i),this.queryObjects={},this.queryType=[e],this.params=r,this.language="it",this.setCurrentLanguage(),this.popupateFiltersFromUrl(),this.registerFiltersListeners(),this.executeCurrentQuery()}function esDevelopersItaliaQuery(e,t){this.config=$.extend({fields:[],language:"it",inputSelector:"",totalSelector:".results-number",pagerSelector:"#paginator",sortSelector:".sortingBy form select",totalText:{it:"risultati",en:"results"},index:"publiccode",type:[],page:0,size:12,elasticsearch_connection:{host:"http://elasticsearch.developers.loc"},queryErrorMessage:{it:"C'è stato un problema nel recuperare i rsultati della ricerca, riprova più tardi",en:"There was a problem finding the search results, please try again later"},intro:{it:"Hai cercato",en:"You have searched for"},autocomplete_all_text:{it:"Cerca in tutto il sito",en:"Search all over the site"},emptySerp:{it:{title:"Nessun risultato trovato",message:'La parola "{keyword}" non ha prodotto nessun risultato. Prova un\'altra chiave di ricerca.',cta:"Prova una nuova ricerca"},en:{title:"No results found",message:'The word "{keyword}" has not produced any results. Try another search key.',cta:"Try a new search"}},pageContent:".list-item-sorting > div",filterKeys:{tags:"list-tags",developmentStatus:"list-status"},category:{it:{missing:{label:"Tipologia Software",id:"missing"},administrations:{label:"Amministrazione",id:"administrations"},software_open:{label:"Software Open Source",id:"software-open"},reuse_software:{label:"Software a Riuso",id:"software-reuse"},projects:{label:"Piattaforme",id:"projects"},api:{label:"API",id:"api"},faqs:{label:"Faqs",id:"faqs"},pages:{label:"Tipologia Software",id:"pages"},posts:{label:"News",id:"news"}},en:{missing:{label:"Software Type",id:"missing"},administrations:{label:"Administration",id:"administrations"},software_open:{label:"Software Open Source",id:"software-open"},reuse_software:{label:"Re-use Software",id:"software-reuse"},projects:{label:"Platforms",id:"projects"},api:{label:"API",id:"api"},faqs:{label:"Faqs",id:"faqs"},pages:{label:"Software Type",id:"pages"},posts:{label:"News",id:"news"}}}},e),this.languages={it:"ita",en:"eng"},this.readMore={it:"Leggi di più",en:"read more"},this.params=t,this.templates=Handlebars.templates,this.client=new elasticsearch.Client(this.config.elasticsearch_connection)}function esDevelopersItaliaPlatformsQuery(e,t){esDevelopersItaliaQuery.call(this,e,t)}function esDevelopersItaliaOpenSourceQuery(e,t){esDevelopersItaliaQuery.call(this,e,t)}function esDevelopersItaliaReuseQuery(e,t){esDevelopersItaliaQuery.call(this,e,t)}function esDevelopersItaliaApiQuery(e,t){esDevelopersItaliaQuery.call(this,e,t)}function esDevelopersItaliaPaQuery(e,t){esDevelopersItaliaQuery.call(this,e,t)}function esDevelopersItaliaCategoryQuery(e,t){esDevelopersItaliaQuery.call(this,e,t)}function esDevelopersItaliaAutocompleteAllQuery(e,t){esDevelopersItaliaQuery.call(this,e,t)}function esDevelopersItaliaAutocompletePlatformsQuery(e,t){esDevelopersItaliaQuery.call(this,e,t),this.searchObjectId="platforms"}function esDevelopersItaliaAutocompleteSoftwareOpenSourceQuery(e,t){esDevelopersItaliaQuery.call(this,e,t),this.searchObjectId="software_open"}function esDevelopersItaliaAutocompleteSoftwareRiusoQuery(e,t){esDevelopersItaliaQuery.call(this,e,t),this.searchObjectId="reuse_software"}function esDevelopersItaliaAutocompleteAPIQuery(e,t){esDevelopersItaliaQuery.call(this,e,t),this.searchObjectId="api"}function esDevelopersItaliaAutocompletePAQuery(e,t){esDevelopersItaliaQuery.call(this,e,t),this.searchObjectId="pa"}esDevelopersItaliaManager.prototype.executeCurrentQuery=function(){var e=this;this.updateSearchUrl(),this.currentQueryObject().executeESQuery().then(function(t){e.currentQueryObject().esSearchSuccessCallback.call(e.currentQueryObject(),t),$(e.config.pagerSelector+" ul li a").on("click",function(t){e.pagerCallback.call(e,t)})},function(t){e.currentQueryObject().esSearchErrorCallback.call(e.currentQueryObject(),t)})},esDevelopersItaliaManager.prototype.pagerCallback=function(e){e.preventDefault();var t=e.delegateTarget.getAttribute("page");this.params.page.pop(),this.params.page.push(t),this.executeCurrentQuery()},esDevelopersItaliaManager.prototype.setCurrentLanguage=function(){var e=location.pathname.substr(1).split("/")[0];-1===["it","en"].indexOf(e)&&(e="it"),this.language=e},esDevelopersItaliaManager.prototype.popupateFiltersFromUrl=function(){var e=this,t={type:"list-type"};for(var i in t){var r=this.params[i],o=t[i];if(0!==r.length)for(var s=0;s<r.length;s++)$("#"+o+' input[value="'+r[s]+'"]').prop("checked",!0),$('#pills-types input[value="'+r[s]+'"]').prop("checked",!0)}for(var i in this.config.filterKeys){r=this.params[i],o=this.config.filterKeys[i];var a=this.config.filterKeysMobileSelectors[i];if(0!==r.length)for(s=0;s<r.length;s++)$("#"+o+' input[value="'+r[s]+'"]').prop("checked",!0),$("#"+a+' input[value="'+r[s]+'"]').prop("checked",!0)}var l=this.params.sort.slice().pop();void 0===l&&(l="relevance"),$(this.config.sortSelector).val(l),$(this.config.sortMobileSelector).each(function(t,i){$(i).attr("sort")===l?($(i).addClass("active"),$(i).html(e.config.sortMobileTitle[e.language][$(i).attr("sort")]+' <i class="it-check"></i>')):($(i).removeClass("active"),$(i).html(e.config.sortMobileTitle[e.language][$(i).attr("sort")]))})},esDevelopersItaliaManager.prototype.updateSearchUrl=function(){var e=[];for(var t in this.config.filterKeys)for(var i=this.params[t],r=0;r<i.length;r++)e.push(t+"["+r+"]="+i[r]);var o=this.params["it-riuso-codiceIPA"].slice(0).pop();void 0!==o&&e.push("it-riuso-codiceIPA="+o);var s=this.params["it-riuso-codiceIPA-label"].slice(0).pop();void 0!==s&&e.push("it-riuso-codiceIPA-label="+s);var a=this.params.type.slice(0).pop();"string"==typeof a&&"all"!==a&&e.push("type="+a);var l=this.params.keyword.slice(0).pop();void 0!==l&&e.push("keyword="+l.split(" ").join("+"));var n=this.params.page.slice(0).pop();void 0===n&&(n=0),e.push("page="+n),e.push("sort="+$(this.config.sortSelector).val()),history.pushState({},"",window.location.pathname+"?"+e.join("&"))},esDevelopersItaliaManager.prototype.registerFiltersListeners=function(){var e=this;$('#list-type input[type="checkbox"]').on("change",function(t){if(t.target.checked){$('#list-type input[type="checkbox"]:checked').each(function(e,i){t.target.value!==i.value&&$(i).prop("checked",!1)});for(var i=$('#pills-types input[type="checkbox"]'),r=0;r<i.length;r++)t.target.value!==i[r].value?$(i[r]).prop("checked",!1):$(i[r]).prop("checked",!0);e.queryType=[t.target.value]}else{for(i=$('#pills-types input[type="checkbox"]'),r=0;r<i.length;r++)$(i[r]).prop("checked",!1);e.queryType=["all"]}0===e.params.type.length?e.params.type.push(e.queryType.slice(0).pop()):(e.params.type.pop(),e.params.type.push(e.queryType.slice(0).pop())),e.executeCurrentQuery()}),$('#pills-types input[type="checkbox"]').on("change",function(e){e.target.checked&&$('#pills-types input[type="checkbox"]:checked').each(function(t,i){e.target.value!==i.value&&$(i).prop("checked",!1)})});for(var t in this.config.filterKeys)$("#"+this.config.filterKeys[t]+' input[type="checkbox"]').on("change",null,{p:t},function(t){e.clickOnFilterCallback.call(e,t)});$(this.config.sortSelector).on("change",function(t){var i=$(e.config.sortMobileSelector+".active");i.html(e.config.sortMobileTitle[e.language][i.attr("sort")]),i.removeClass("active"),$(e.config.sortMobileSelector).each(function(i,r){$(r).attr("sort")===t.target.value&&($(r).addClass("active"),$(r).html(e.config.sortMobileTitle[e.language][$(r).attr("sort")]+' <i class="it-check"></i>'))}),e.executeCurrentQuery()}),$("#filters .modal-dialog .modal-header a.save").on("click",function(t){for(var i in e.config.filterKeys){e.config.filterKeys[i];for(var r=e.config.filterKeysMobileSelectors[i],o=$("#"+r+' input[type="checkbox"]'),s=0;s<o.length;s++){o[s].checked&&-1===e.params[i].indexOf(o[s].value)&&(e.params[i].push(o[s].value),$("#"+e.config.filterKeys[i]+' input[value="'+o[s].value+'"]').prop("checked",!0));var a=e.params[i].indexOf(o[s].value);o[s].checked||-1===a||(e.params[i].splice(a,1),$("#"+e.config.filterKeys[i]+' input[value="'+o[s].value+'"]').prop("checked",!1))}}$('#list-type input[type="checkbox"]').prop("checked",!1);var l=$('#pills-types input[type="checkbox"]:checked'),n="all";l.length>0&&(n=l.val(),$('#list-type input[value="'+n+'"]').prop("checked",!0)),e.params.type.length>0&&e.params.type.pop(),e.params.type.push(n),e.queryType=[n],e.executeCurrentQuery()}),$(this.config.sortMobileSelector).on("click",function(t){if(t.preventDefault(),!$(t.target).hasClass("active")){var i=$(e.config.sortMobileSelector+".active");i.html(e.config.sortMobileTitle[e.language][i.attr("sort")]),i.removeClass("active"),$(t.target).html(e.config.sortMobileTitle[e.language][$(t.target).attr("sort")]+' <i class="it-check"></i>'),$(t.target).addClass("active")}var r=$(e.config.sortMobileSelector+".active").attr("sort");$(e.config.sortSelector).val(r),e.executeCurrentQuery(),$(e.config.sortMobileModal).modal("hide")})},esDevelopersItaliaManager.prototype.removeFiltersListeners=function(){for(var e in this.config.filterKeys)$("#"+this.config.filterKeys[e]+' input[type="checkbox"]').off("change");$(this.config.sortSelector).off("change")},esDevelopersItaliaManager.prototype.clickOnFilterCallback=function(e){e.target.checked?(this.params[e.data.p].push(e.target.value),$("#"+this.config.filterKeysMobileSelectors[e.data.p]+' input[value="'+e.target.value+'"]').prop("checked",!0)):(this.params[e.data.p]=this.params[e.data.p].filter(function(t,i){return t!==e.target.value}),$("#"+this.config.filterKeysMobileSelectors[e.data.p]+' input[value="'+e.target.value+'"]').prop("checked",!1)),this.params.page.pop(),this.executeCurrentQuery()},esDevelopersItaliaManager.prototype.currentQueryObject=function(){var e=this.queryType.slice(0).pop();return void 0===this.queryObjects[e]&&(this.queryObjects[e]=this.createQueryObject(e)),this.queryObjects[this.queryType]},esDevelopersItaliaManager.prototype.createQueryObject=function(e){var t,i=$.extend({},this.objectConfig[e]);switch(i.language=this.language,e){case"all":t=new esDevelopersItaliaQuery(i,this.params);break;case"platforms":t=new esDevelopersItaliaPlatformsQuery(i,this.params);break;case"software_open":t=new esDevelopersItaliaOpenSourceQuery(i,this.params);break;case"reuse_software":t=new esDevelopersItaliaReuseQuery(i,this.params);break;case"api":t=new esDevelopersItaliaApiQuery(i,this.params);break;case"category":t=new esDevelopersItaliaCategoryQuery(i,this.params);break;case"administrations":t=new esDevelopersItaliaPaQuery(i,this.params)}return t},esDevelopersItaliaQuery.prototype.getFilterInQuery=function(){var e=[];for(var t in this.config.filterKeys){var i=this.params[t];if(0!==i.length)for(var r=0;r<i.length;r++){var o={term:{}};o.term[t]=i[r],e.push(o)}}var s=this.params["it-riuso-codiceIPA"].slice(0).pop();return void 0!==s&&e.push({term:{"it-riuso-codiceIPA":s}}),e},esDevelopersItaliaQuery.prototype.getIndexQuery=function(e){return this.config.index},esDevelopersItaliaQuery.prototype.getDocumentTypeQuery=function(e){return Array.isArray(this.config.type)?this.config.type.slice(0):this.config.type},esDevelopersItaliaQuery.prototype.getFromQuery=function(e){var t=void 0!==this.params&&void 0!==this.params.page?this.params.page.slice(0).pop():0;return void 0===t?0:t*this.config.size},esDevelopersItaliaQuery.prototype.getSizeQuery=function(e){return this.config.size},esDevelopersItaliaQuery.prototype.getSortQuery=function(){var e=[];switch($(this.config.sortSelector).val()){case"az":e.push({"name.sort":{order:"asc"}});break;case"za":e.push({"name.sort":{order:"desc"}});break;case"popularity":e.push({"vitality-score":{order:"desc"}});break;case"emerging":e.push({releaseDate:{order:"desc"}})}return e},esDevelopersItaliaQuery.prototype.esSearchSuccessCallback=function(e){var t="";if(void 0!==e.hits&&void 0!==e.hits.hits&&Array.isArray(e.hits.hits)){if(void 0!==this.throbber&&this.throbber.stop(),$(this.config.pageContent).text(""),0===e.hits.total){var i=this.params.keyword.slice(0).pop();return void this.renderEmptyResults(i)}this.renderResultCount(e.hits.total);for(var r=0;r<e.hits.hits.length;r++){switch(e.hits.hits[r]._type){case"software":t=this.renderSoftware(e.hits.hits[r]._source);break;case"post":t=this.renderPost(e.hits.hits[r]._source);break;case"administration":t=this.renderAdministration(e.hits.hits[r]._source)}$(this.config.pageContent).append(t)}this.renderPager(e.hits.total)}},esDevelopersItaliaQuery.prototype.esSearchErrorCallback=function(e){void 0!==this.throbber&&this.throbber.stop(),this.renderErrorMessage()},esDevelopersItaliaQuery.prototype.getQuery=function(){var e=this.params.keyword.slice(0).pop(),t=this.getFilterInQuery(),i=this.config.language,r=this.languages[i],o={query:{bool:{must:[{bool:{should:[{bool:{must:[{term:{_type:"post"}},{terms:{type:["projects"]}},{term:{lang:i}}],must_not:{match:{"intended-audience-unsupported-countries":"it"}}}},{term:{_type:"software"}},{term:{_type:"administration"}}]}}]}}};return void 0!==e&&(e=e.split("+").join(" "),o.query.bool.must.push({multi_match:{query:void 0===e?"":e,fields:["name?6","description."+r+".localizedName^6","description."+r+".shortDescription^5","description."+r+".longDescription^4","title^6","subtitle^5","html^4","it-riuso-codiceIPA-label^6","name^3","description."+r+".localizedName^3","description."+r+".shortDescription^2","description."+r+".longDescription","title^3","subtitle^2","html"]}})),t.length>0&&(o.query.bool.filter=t),o},esDevelopersItaliaQuery.prototype.executeESQuery=function(){this.renderIntro(),$(this.config.pageContent).text(""),this.throbber=Throbber({color:"black",padding:30,size:100,fade:200,clockwise:!1}).appendTo($(".list-item-sorting > div")[0]).start();var e=this.getIndexQuery(),t=this.getDocumentTypeQuery(),i=this.getQuery();i.sort=this.getSortQuery();var r={index:e,body:i,from:this.getFromQuery(),size:this.getSizeQuery()};return t.length>0&&(r.type=t),this.client.search(r)},esDevelopersItaliaQuery.prototype.renderErrorMessage=function(){var e=this.config.language,t=this.templates.message({class:"",message:this.config.queryErrorMessage[e]});$(this.config.pageContent).html(t)},esDevelopersItaliaQuery.prototype.renderIntro=function(e){var t=this.params.keyword.slice(0).pop(),i=this.config.language,r=$(".intro > h1");void 0!==t&&(r.text(""),r.html(this.config.intro[i]+' "'+t.split("+").join(" ")+'"'))},esDevelopersItaliaQuery.prototype.renderResultCount=function(e){var t=this.config.language;$(this.config.totalSelector).html(this.templates.tot({tot:e,text:this.config.totalText[t]}))},esDevelopersItaliaQuery.prototype.renderEmptyResults=function(e){var t=this.config.language;$(".intro").html(this.templates.empty({title:this.config.emptySerp[t].title,message:this.config.emptySerp[t].message.replace("{keyword}",e),cta:this.config.emptySerp[t].cta}))},esDevelopersItaliaQuery.prototype.renderPager=function(e){if($(this.config.pagerSelector+" ul li a").off("click"),$(this.config.pagerSelector).text(""),!(e<this.config.size)){var t=0,i=this.config.size,r=this.params.page.slice(0).pop(),o=Math.ceil(e/i),s=[];void 0===r&&(r=0),(r=parseInt(r))>4&&(t=r-4);for(var a=t;a<t+9&&!(a>=o);a++)s.push({title:a+1,classes:a===r?" active ":"",current:r===a,page:a});var l={title:"<",classes:r===t?" disabled ":"",current:!1,page:r-1},n={title:">",classes:r===o-1?" disabled ":"",current:!1,page:r+1};$(this.config.pagerSelector).append(this.templates.pager({pages:s,prev:l,next:n}))}},esDevelopersItaliaQuery.prototype.renderSoftware=function(e){var t=this.getSoftwareScreenshot(e),i=e.name,r=e.id,o=this.config.language,s=this.getSoftwareType(e);void 0!==e.description[this.languages[o]].screenshots&&e.description[this.languages[o]].screenshots.length>0&&(t=e.description[this.languages[o]].screenshots.slice(0).pop()),void 0!==e.description[this.languages[o]].localisedName&&(i=e.description[this.languages[o]].localisedName);var a={name:name,localisedName:decodeHtmlEntity(i),language:this.config.language,screenshot:t,readMore:this.readMore[o],category:s.label.toUpperCase(),categoryClass:["icon","icon-type-"+s.id].join(" "),path:"/"+o+"/software/"+r+"/"+e.name.toLowerCase().split(" ").join("-")};return this.templates.search(a)},esDevelopersItaliaQuery.prototype.renderPost=function(e){var t=this.getPostScreenshot(e),i=e.title,r=this.config.language,o=this.getPostType(e);void 0===e.logo&&null===e.logo||(t=e.logo);var s={name:e.title,localisedName:decodeHtmlEntity(i),language:r,screenshot:t,readMore:this.readMore[r],category:o.label.toUpperCase(),categoryClass:["icon","icon-type-"+o.id].join(" "),path:e.url};return this.templates.search(s)},esDevelopersItaliaQuery.prototype.renderAdministration=function(e){var t=this.config.language,i={name:e["it-riuso-codiceIPA-label"],localisedName:e["it-riuso-codiceIPA-label"],language:t,screenshot:"/assets/images/cover_amministrazioni.png",readMore:this.readMore[t],category:"administration",categoryClass:["icon","icon-type-administration"].join(" "),path:"/"+t+"/amministrazioni?it-riuso-codiceIPA="+e["it-riuso-codiceIPA"]+"&it-riuso-codiceIPA-label="+e["it-riuso-codiceIPA-label"]};return this.templates.search(i)},esDevelopersItaliaQuery.prototype.getSoftwareType=function(e){var t=this.config.language;this.config.category[t].missing;return null==e["it-riuso-codiceIPA"]?this.config.category[t].software_open:this.config.category[t].reuse_software},esDevelopersItaliaQuery.prototype.getSoftwareScreenshot=function(e){return null==e["it-riuso-codiceIPA"]?"/assets/images/cover_softwareriuso.png":"/assets/images/cover_software opensource.png"},esDevelopersItaliaQuery.prototype.getPostType=function(e){var t=this.config.language,i=this.config.category[t].missing;return void 0!==e.type&&(i=this.config.category[t][e.type]),i},esDevelopersItaliaQuery.prototype.getPostScreenshot=function(e){var t="http://via.placeholder.com/350x150";switch(e.type){case"projects":t="/assets/images/cover_piattaforme.png"}return t},esDevelopersItaliaPlatformsQuery.prototype=Object.create(esDevelopersItaliaQuery.prototype),esDevelopersItaliaPlatformsQuery.prototype.getQuery=function(){var e=this.params.keyword.slice(0).pop(),t=this.getFilterInQuery(),i={query:{bool:{must:[],must_not:{match:{"intended-audience-unsupported-countries":"it"}},filter:[{term:{type:"projects"}},{term:{lang:this.config.language}}]}}};return void 0!==e&&(e=e.split("+").join(" "),i.query.bool.must.push({multi_match:{query:e,fields:["title^6","subtitle^5","title^3","subtitle^2","html"]}})),t.length>0&&(i.query.bool.filter=t),i},esDevelopersItaliaOpenSourceQuery.prototype=Object.create(esDevelopersItaliaQuery.prototype),esDevelopersItaliaOpenSourceQuery.prototype.getQuery=function(){var e=this.params.keyword.slice(0).pop(),t=this.getFilterInQuery(),i=this.config.language,r=this.languages[i],o={query:{bool:{must:[],must_not:[{exists:{field:"it-riuso-codiceIPA"}},{match:{"intended-audience-unsupported-countries":"it"}}]}}};return void 0!==e&&(e=e.split("+").join(" "),o.query.bool.must.push({multi_match:{query:e,fields:["name?6","description."+r+".localizedName^6","description."+r+".shortDescription^5","description."+r+".longDescription^4","name^3","description."+r+".localizedName^3","description."+r+".shortDescription^2","description."+r+".longDescription"]}})),t.length>0&&(o.query.bool.filter=t),o},esDevelopersItaliaReuseQuery.prototype=Object.create(esDevelopersItaliaQuery.prototype),esDevelopersItaliaReuseQuery.prototype.getQuery=function(){var e=this.params.keyword.slice(0).pop(),t=this.getFilterInQuery(),i=this.config.language,r=this.languages[i],o={query:{bool:{must:[{exists:{field:"it-riuso-codiceIPA"}},{term:{_type:"software"}}],must_not:{match:{"intended-audience-unsupported-countries":"it"}}}}};return void 0!==e&&(e=e.split("+").join(" "),o.query.bool.must.push({multi_match:{query:e,fields:["name?6","description."+r+".localizedName^6","description."+r+".shortDescription^5","description."+r+".longDescription^4","it-riuso-codiceIPA-label^6","name^3","description."+r+".localizedName^3","description."+r+".shortDescription^2","description."+r+".longDescription"]}})),t.length>0&&(o.query.bool.filter=t),o},esDevelopersItaliaApiQuery.prototype=Object.create(esDevelopersItaliaQuery.prototype),esDevelopersItaliaApiQuery.prototype.getQuery=function(){var e=this.params.keyword.slice(0).pop(),t=this.getFilterInQuery(),i={query:{bool:{must:[],filter:[{term:{type:"api"}},{term:{lang:this.config.language}}]}}};return void 0!==e&&(e=e.split("+").join(" "),i.query.bool.must.push({multi_match:{query:e,fields:["title^6","subtitle^5","title^3","subtitle^2","html"]}})),t.length>0&&(i.query.bool.filter=t),i},esDevelopersItaliaPaQuery.prototype=Object.create(esDevelopersItaliaQuery.prototype),esDevelopersItaliaPaQuery.prototype.getQuery=function(){var e=this.params.keyword.slice(0).pop(),t=this.getFilterInQuery(),i=this.config.language,r=this.languages[i],o={query:{bool:{must:[]}}};return void 0!==e&&(e=e.split("+").join(" "),o.query.bool.must.push({multi_match:{query:e,fields:["name?6","description."+r+".localizedName^6","description."+r+".shortDescription^5","description."+r+".longDescription^4","name^3","description."+r+".localizedName^3","description."+r+".shortDescription^2","description."+r+".longDescription"]}})),t.length>0&&(o.query.bool.filter=t),o},esDevelopersItaliaPaQuery.prototype.renderIntro=function(e){var t=this.params["it-riuso-codiceIPA-label"].slice(0).pop(),i=$(".intro > h1");void 0!==t&&(i.text(""),i.html(decodeURI(t)))},esDevelopersItaliaCategoryQuery.prototype=Object.create(esDevelopersItaliaQuery.prototype),esDevelopersItaliaAutocompleteAllQuery.prototype=Object.create(esDevelopersItaliaQuery.prototype),esDevelopersItaliaAutocompleteAllQuery.prototype.getQuery=function(){var e=this.config.language,t=this.languages[e];return{query:{bool:{must:[{multi_match:{query:$(this.config.inputSelector).val(),fields:["name^3","it-riuso-codiceIPA-label^3","title^3","subtitle^2","description."+t+".localizedName^3","description."+t+".shortDescription^2","description."+t+".longDescription","html"]}},{bool:{should:[{bool:{must:[{term:{_type:"post"}},{terms:{type:["projects","posts"]}},{term:{lang:e}}]}},{term:{_type:"software"}},{term:{_type:"administration"}}]}}],must_not:[{match:{"intended-audience-unsupported-countries":"it"}}]}}}},esDevelopersItaliaAutocompleteAllQuery.prototype.executeESQuery=function(){var e=this.getIndexQuery(),t=this.getDocumentTypeQuery(),i=this,r={index:e,body:this.getQuery(),from:this.getFromQuery(),size:this.getSizeQuery()};t.length>0&&(r.type=t),this.client.search(r).then(function(e){i.esSearchSuccessCallback.call(i,e)},function(e){i.esSearchErrorCallback.call(i,e)})},esDevelopersItaliaAutocompleteAllQuery.prototype.getSuggestionDataSoftware=function(e){var t=$(this.config.inputSelector).val(),i=this.config.language,r=e.name,o=e.id,s=this.languages[i],a=this.getSoftwareType(e);void 0!==e.description[s]&&"undefined"!==e.description[s].localisedName&&(r=e.description[s].localisedName),t=t.trim().split(" ");for(var l=0;l<t.length;l++)r=r.replace(new RegExp(t[l],"ig"),"<b>$&</b>");return{name:r,language:i,category:a.label.toUpperCase(),categoryClass:["category","icon","icon-type-"+a.id].join(" "),path:"/"+i+"/software/"+o+"/"+e.name.toLowerCase().split(" ").join("-")}},esDevelopersItaliaAutocompleteAllQuery.prototype.getSuggestionDataPost=function(e){var t=$(this.config.inputSelector).val(),i=e.title,r=this.getPostType(e);t=t.trim().split(" ");for(var o=0;o<t.length;o++)i=i.replace(new RegExp(t[o],"ig"),"<b>$&</b>");return{name:i,language:this.config.language,category:r.label.toUpperCase(),categoryClass:["category","icon","icon-type-"+r.id].join(" "),path:e.url}},esDevelopersItaliaAutocompleteAllQuery.prototype.getSuggestionDataAdministration=function(e){var t=$(this.config.inputSelector).val(),i=this.config.language,r=e["it-riuso-codiceIPA-label"],o="/"+i;t=t.trim().split(" ");for(var s=0;s<t.length;s++)r=r.replace(new RegExp(t[s],"ig"),"<b>$&</b>");return o+="it"===i?"/amministrazioni":"/administrations",o+="?"+["it-riuso-codiceIPA="+e["it-riuso-codiceIPA"],"it-riuso-codiceIPA-label="+e["it-riuso-codiceIPA-label"]].join("&"),{name:r,language:i,category:this.config.category[i].administrations.label,categoryClass:["category","icon","icon-type-"+this.config.category[i].administrations.id].join(" "),path:o}},esDevelopersItaliaAutocompleteAllQuery.prototype.esSearchSuccessCallback=function(e){var t=this.config.language,i=$("#suggestions");i.text("");var r=$(this.config.inputSelector).val();if(0!==r.length&&void 0!==e.hits&&void 0!==e.hits.hits&&Array.isArray(e.hits.hits)){for(var o=0;o<e.hits.hits.length;o++){var s;"software"===e.hits.hits[o]._type&&(s=this.getSuggestionDataSoftware(e.hits.hits[o]._source)),"post"===e.hits.hits[o]._type&&(s=this.getSuggestionDataPost(e.hits.hits[o]._source)),"administration"===e.hits.hits[o]._type&&(s=this.getSuggestionDataAdministration(e.hits.hits[o]._source)),i.append(this.templates.suggestion(s))}var a=["keyword="+r.trim().split(" ").join("+")];i.append(this.templates.suggestion({name:this.config.autocomplete_all_text[t],language:this.config.language,path:"/"+t+"/search?"+a.join("&")}))}},esDevelopersItaliaAutocompletePlatformsQuery.prototype=Object.create(esDevelopersItaliaAutocompleteAllQuery.prototype),esDevelopersItaliaAutocompletePlatformsQuery.prototype.getQuery=function(){return{query:{bool:{must:[{multi_match:{query:$(this.config.inputSelector).val(),fields:["title^3","subtitle^2","html"]}}],filter:[{term:{type:"projects"}},{term:{lang:this.config.language}}]}}}},esDevelopersItaliaAutocompleteSoftwareOpenSourceQuery.prototype=Object.create(esDevelopersItaliaAutocompleteAllQuery.prototype),esDevelopersItaliaAutocompleteSoftwareOpenSourceQuery.prototype.getQuery=function(){var e=this.config.language,t=this.languages[e];return{query:{bool:{must:[{multi_match:{query:$(this.config.inputSelector).val(),fields:["name^3","description."+t+".localizedName^3","description."+t+".shortDescription^2","description."+t+".longDescription"]}},{term:{_type:"software"}}],must_not:[{exists:{field:"it-riuso-codiceIPA"}},{match:{"intended-audience-unsupported-countries":"it"}}]}}}},esDevelopersItaliaAutocompleteSoftwareRiusoQuery.prototype=Object.create(esDevelopersItaliaAutocompleteAllQuery.prototype),esDevelopersItaliaAutocompleteSoftwareRiusoQuery.prototype.getQuery=function(){var e=this.config.language,t=this.languages[e];return{query:{bool:{must:[{multi_match:{query:$(this.config.inputSelector).val(),fields:["name^3","description."+t+".localizedName^3","description."+t+".shortDescription^2","description."+t+".longDescription"]}},{term:{_type:"software"}},{exists:{field:"it-riuso-codiceIPA"}}]}}}},esDevelopersItaliaAutocompleteAPIQuery.prototype=Object.create(esDevelopersItaliaAutocompleteAllQuery.prototype),esDevelopersItaliaAutocompleteAPIQuery.prototype.getQuery=function(){return{query:{bool:{must:[{multi_match:{query:$(this.config.inputSelector).val(),fields:["title^3","subtitle^2","html"]}}],filter:[{term:{type:"api"}},{term:{lang:this.config.language}}]}}}},esDevelopersItaliaAutocompletePAQuery.prototype=Object.create(esDevelopersItaliaAutocompleteAllQuery.prototype),esDevelopersItaliaAutocompletePAQuery.prototype.getQuery=function(){return{query:{bool:{must:[{multi_match:{query:$(this.config.inputSelector).val(),fields:["it-riuso-codiceIPA-label"]}},{term:{_type:"administration"}}]}}}};